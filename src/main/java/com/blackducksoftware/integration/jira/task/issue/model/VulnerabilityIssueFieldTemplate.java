/*
 * Copyright (C) 2018 Black Duck Software Inc.
 * http://www.blackducksoftware.com/
 * All rights reserved.
 *
 * This software is the confidential and proprietary information of
 * Black Duck Software ("Confidential Information"). You shall not
 * disclose such Confidential Information and shall use it only in
 * accordance with the terms of the license agreement you entered into
 * with Black Duck Software.
 */
package com.blackducksoftware.integration.jira.task.issue.model;

import java.util.HashMap;
import java.util.Map;

import com.atlassian.jira.issue.fields.CustomField;
import com.atlassian.jira.user.ApplicationUser;
import com.blackducksoftware.integration.jira.common.model.PluginField;

public class VulnerabilityIssueFieldTemplate extends BlackDuckIssueFieldTemplate {
    private final String componentVersionOriginName;
    private final String componentVersionOriginId;

    // @formatter:off
    private VulnerabilityIssueFieldTemplate(
             final ApplicationUser projectOwner
            ,final String projectName
            ,final String projectVersionName
            ,final String projectVersionUri
            ,final String projectVersionNickname
            ,final String componentName
            ,final String componentVersionName
            ,final String componentVersionUri
            ,final String componentVersionOriginName
            ,final String componentVersionOriginId
            ,final String licenseString
            ,final String licenseLink
            ,final String usagesString
            ,final String updatedTimeString
            ) {
        super(projectOwner, projectName, projectVersionName, projectVersionUri, projectVersionNickname, componentName, null, componentVersionName, componentVersionUri, licenseString, licenseLink, usagesString, updatedTimeString);
        this.componentVersionOriginName = componentVersionOriginName;
        this.componentVersionOriginId = componentVersionOriginId;
    }
    // @formatter:on

    public String getComponentVersionOriginName() {
        return componentVersionOriginName;
    }

    public String getComponentVersionOriginId() {
        return componentVersionOriginId;
    }

    @Override
    protected Map<Long, String> getAddtionalHubFieldMappings(final Map<PluginField, CustomField> customFields) {
        final Map<Long, String> policyFieldMappings = new HashMap<>();
        addCustomField(customFields, policyFieldMappings, PluginField.HUB_CUSTOM_FIELD_COMPONENT_ORIGIN, componentVersionOriginName);
        addCustomField(customFields, policyFieldMappings, PluginField.HUB_CUSTOM_FIELD_COMPONENT_ORIGIN_ID, componentVersionOriginId);
        return policyFieldMappings;
    }

}
